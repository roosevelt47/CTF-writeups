## Are you sane?

This is a web sanity check, hopefully everyone is sane.

I used [ZAP](https://www.zaproxy.org/) to scan for hidden or accessible paths on the server. Through this scan, I discovered three files that were accessible:

![](Pasted%20image%2020241111215926.png)
![](Pasted%20image%2020241111215958.png)

`4T${7h15-f1l3-W45-N07-h1DD3N}`


# Misc

## Trace the Ghost
![](Pasted%20image%2020241111220103.png)
I had access to the server and needed to find the flag. I simply explored the directory and after a but used the `ls -a` command to list all files, including hidden ones. This allowed me to find the flag easily. This reminded me of Mr Robot, very fun!

![](Pasted%20image%2020241111220215.png)

`4T${L€4vE_mE_Her€}`

## Stirling

I had two PDF files: one with a password and another containing mathematical formulas. It became clear that I needed to find the password hidden inside the second PDF. After conducting several searches through the PDF for strings, comments, and other clues, I used an online tool, [Inspect PDF](https://pdfcrowd.com/inspect-pdf/), to analyze the document.

![](Pasted%20image%2020241111220519.png)

Password was `Adm!nNDAop`

I was able to access and extract the flag from the first pdf.

![](Pasted%20image%2020241111220631.png)

`4T${heyJSPDFEmb3d3d}`

## Water on Mars

The input is just this image:

![](mars.jpg)

Using a quick Stegno tool: [Aperisolve](https://www.aperisolve.com/):

![](Pasted%20image%2020241111220914.png)

`4T${W4T3R<3}`

# Crypto

## Not so private

Input: n, e, and cf. A classic RSA crypto challenge.

```python
n = 24184405921426813952257404599844172064081900441874911388193652630310202789495631574938639097579036296101853234084915009375105829951961044132903535773924370570635332237832028283789889280165403481654234745557486403470274088268474644426048449169536944543970537467352336781804911800773427862282122961246703917704568734038884635778376198127691642199423912956685671445503565723497448770592525438558805325647407374824270703532081624469904632124745208505061145540656760946859657371270888296303072821867249045709759196878699068410554299707085233635566878012647656106156406503857113207  
e = 65537   
cf = 19949070990331976245949375301773799373206800804362632168364316553540430616830618653790469820828363016574115997704094863829732182137092831141159044101049172034884217341208278135632024598752036879352726375804431415940381410379858267677290511438684691665260067686568252722840144131544524130614320199820713749708063642505970041091970221332182634285081892576008284361856437472575724015987128320812953565466004548726671456646020677256311338766802480861734450302201585275812208617677229147872618475814224684268204020352159322992065216537963716573003898076957096748095052514990199352
```

Using this [website](https://www.alpertron.com.ar/ECM.HTM), I was able to find the prime factors of `n`. Then I used a Python script to calculate the private key `d`and decrypt the ciphertext (`cf`) to retrieve the flag.

```python

prime_factors = [  
    9308809837340399653,9638656009474996247,10172067034866822329,10354784369698224719,11209486700740045189,11346323158137382339,11354147304116634911,11764352138541927941,12173970345611589103,13161288593188783501,13232429251966529279,13688640699874074247,14198816595521136841,14476726661472037681,14731435635793702433,14861104142259777419,15169799324952462451,15238470019725544583,15415799843802438209,15511003127367003967,15745096712251841113,15878969227403060279,16576514605788751547,16630719954639992581,16671653695109508187,16728097962753531677,17996055586202421529,18063314945654761219,18185405107246550969,18362837959013960089  
]  
  
phi_n = 1  
for p in prime_factors:  
    phi_n *= (p - 1)  
e = 65537    
d = mod_inverse(e, phi_n)  
cf = 19949070990331976245949375301773799373206800804362632168364316553540430616830618653790469820828363016574115997704094863829732182137092831141159044101049172034884217341208278135632024598752036879352726375804431415940381410379858267677290511438684691665260067686568252722840144131544524130614320199820713749708063642505970041091970221332182634285081892576008284361856437472575724015987128320812953565466004548726671456646020677256311338766802480861734450302201585275812208617677229147872618475814224684268204020352159322992065216537963716573003898076957096748095052514990199352    
n = 1  
for p in prime_factors:  
    n *= p  
m = pow(cf, d, n)  
print(f"Private key d: {d}")  
print(f"Decrypted message m: {m}")  
m_bytes = m.to_bytes((m.bit_length() + 7) // 8, 'big')  
decoded_message = m_bytes.decode('utf-8')  
print(f"Decoded message: {decoded_message}")
```

`4T${sadly_this_is_too_much_prime_my_son}`

# Gam-Gam

Input: the script used to encrypt with RSA and n, e, cf.

Encryption Script:

```python
from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes  
from flags import FLAG_GAMGAM  
  
def gen_key():  
    p = getPrime(4096)  
    n = 2*p  
    e = 65537  
    phi_n = (p - 1)  
    d = pow(e, -1, phi_n)  
    return (n, e), (n, d)  
def encrypt(pt: int, pub_key: (int, int)) -> int:  
    n, e = pub_key  
    return pow(pt, e, n)  
def decrypt(ct: int, priv_key: (int, int)) -> int:  
    n, d = priv_key  
    return pow(ct, d, n)  
pt = bytes_to_long(FLAG_GAMGAM)  
pub, priv = gen_key()  
ct = encrypt(pt, pub)  
print(pub)  
print(ct)  
""" output :   
pub = (1187036881143255678002463758823328059054967286304079946698830107983054756455116137560640360907617090768892222200232769013898086641365526920365941657223719909608623612364565491394396836689005779953582737606769612044152900984410189797945160970640233269434857215156707188226644140186233117418578999649675501923158500973527860820476774162258056088176836933971626651722297419469001832141393303687831763041541298637984981484605886538085054999743028130034186150375954369138007688335922353720290223733062752735362640330007395278113210621407774253326748367183647916542260385241849328645829055161868897760626313462053770486741600871918596910274170809764858924373557759944088849747488101309508664734646761762412297919300985341470183672896494363089287897564003884864937477882116184866139314943820121458541671053111784924614354354051278861337795171453392846554516472806170955424094756390970572454084554064299959563385403753982420758416150497980281277588694172034437436874006653172021381177623273333042379989422646166480734410913148567193586525237775287519085811109666011917375279015787726665088346364963313941503929463975682736763812440239892582271133388552728034109040233071519106207594592661468817905961569517921007110971395505830618097714478302, 65537)  
ct = 795807804195143453698199351714341881491007858193124317249991960343873442402330541927355975462857321435938754440321580174443331666641181625664069405050964566344381744709294110771870536802353007022271867378658681771017152652337537847752445300535171488167996282441962543976576696465573991060306807268553659109840313328518099780850408480656440234846473549017585724141302898515099966486748289860601838615696366759534875502563433987281076478746704673766615604679732113066945172837918782569635525478298453073137252252807049842035005266808708242245205256476149494296039430508531375107451338401537609064664390446408507706477965483671800993119312002909135270398571898844908643483215653937390863031730605961379386046951618745731912613235578147115643378764728145934422515365821994913473759604466504627671738552946527189180057717976411101700962342930065732023681381389942592202841123754672836935980227561011259880242223658584675417448037977336301973044247690228389495603711704632306639520856078639797104835378636642939190389932673963835980987694812947833691746134338765367684261289851826492260573430796933048931658801423183863572727478714738535956082504958502080116828296338104460121704114347331800007862970894127699814246457589160922514051314061  
"""
```

Since `n = 2 * p`, it's easy to find `p` by simply dividing `n` by 2. Once we know `p`, we can calculate `d`, the private exponent, and decrypt the ciphertext.

Here’s the Python code to decrypt the ciphertext:

```python
from Crypto.Util.number import inverse, long_to_bytes  
from Crypto.PublicKey import RSA  
  
# Given values  
n = 1187036881143255678002463758823328059054967286304079946698830107983054756455116137560640360907617090768892222200232769013898086641365526920365941657223719909608623612364565491394396836689005779953582737606769612044152900984410189797945160970640233269434857215156707188226644140186233117418578999649675501923158500973527860820476774162258056088176836933971626651722297419469001832141393303687831763041541298637984981484605886538085054999743028130034186150375954369138007688335922353720290223733062752735362640330007395278113210621407774253326748367183647916542260385241849328645829055161868897760626313462053770486741600871918596910274170809764858924373557759944088849747488101309508664734646761762412297919300985341470183672896494363089287897564003884864937477882116184866139314943820121458541671053111784924614354354051278861337795171453392846554516472806170955424094756390970572454084554064299959563385403753982420758416150497980281277588694172034437436874006653172021381177623273333042379989422646166480734410913148567193586525237775287519085811109666011917375279015787726665088346364963313941503929463975682736763812440239892582271133388552728034109040233071519106207594592661468817905961569517921007110971395505830618097714478302  
e = 65537  
cf = 795807804195143453698199351714341881491007858193124317249991960343873442402330541927355975462857321435938754440321580174443331666641181625664069405050964566344381744709294110771870536802353007022271867378658681771017152652337537847752445300535171488167996282441962543976576696465573991060306807268553659109840313328518099780850408480656440234846473549017585724141302898515099966486748289860601838615696366759534875502563433987281076478746704673766615604679732113066945172837918782569635525478298453073137252252807049842035005266808708242245205256476149494296039430508531375107451338401537609064664390446408507706477965483671800993119312002909135270398571898844908643483215653937390863031730605961379386046951618745731912613235578147115643378764728145934422515365821994913473759604466504627671738552946527189180057717976411101700962342930065732023681381389942592202841123754672836935980227561011259880242223658584675417448037977336301973044247690228389495603711704632306639520856078639797104835378636642939190389932673963835980987694812947833691746134338765367684261289851826492260573430796933048931658801423183863572727478714738535956082504958502080116828296338104460121704114347331800007862970894127699814246457589160922514051314061  
# Solution  
p = n // 2  
phi_n = p - 1  
d = inverse(e, phi_n)  
pt = pow(cf, d, n)  
pt_bytes = long_to_bytes(pt)  
print(f"Decrypted message: {pt_bytes.decode()}")
```

`4T${one_to_rule_them_all}`

# Matematik

Input: as before an Encryption Script:

```python
from math import gcd  
from Crypto.Util.number import bytes_to_long, getPrime, getRandomNBitInteger  
from flags import FLAG_MATEMATIK  
  
def gen_key():  
    p = getPrime(2048)  
    q = getPrime(2048)  
    n = p * q  
    phi_n = (p - 1) * (q - 1)  
    d = getRandomNBitInteger(1024)  
    while (3 * d)**4 < n < d**0.292:  
        d = getRandomNBitInteger(1024)  
    e = pow(d, -1, phi_n)  
    return (n, e), (n, d)  
def encrypt(pt: int, pub_key: (int, int)) -> int:  
    n, e = pub_key  
    return pow(pt, e, n)  
def decrypt(ct: int, priv_key: (int, int)) -> int:  
    n, d = priv_key  
    return pow(ct, d, n)  
pt = bytes_to_long(FLAG_MATEMATIK)  
pub, priv = gen_key()  
ct = encrypt(pt, pub)  
print(pub)  
print(ct)  
""" output :   
pub = (813291308603414089290668124041839733918488102866707584478634305319455045742732398934285162590313628856151815805790620427282606419733953720940672900768927843456798354736166539116245629511099027050834359384831529357375361650207922031319202531732346130779684513880916453362321181490895712150208665938936278172640305188677018153679323752530891790061335976403796874283838241633986457526745812030002471049604945974200148937982826320771554655435614757483499493911336752954800985578910845367956516996617229558390523818494709361186658914477419251812995871366351489494308292606000804614366845051918199227844254546329541843568318237109632457847134885083162397820112825732852216955328660838562813889545261894305894160609220887968790944587321188098754603643013421664631133010093611556497233001653201895232543427082211683021364712220647876947616554074640514028751536406658385579193774470930187879078899695146964706436953032128385848122414086434213809075484348842559074698856998042069709556057058143190691596178593402659233400344987806988713656452553047776818230138111821734002434933579554120175239589824745274138505528074316535235675310159751338868381402667299087497293471199173475186425479086169119058202621574904341235785246634876364612171762039, 507629470812273261823426390546598338984395989442071474050416785320440010159634016383832635630627366973849528238182510962137111640508110790495315940357236952175068500887330221534610953600273841963487815952694025077621388297338394497587374864453412549069891512740981002243575242455039752608668327752194980276553830616717081535140131472469003490922930873685871639979453889383771636442013652167366168345651503969931023708386430496255530725148293969510474787981494451982469823070955933396841763617850694834638657960004417960227867460846597255166692801940250504317372628474735332077991643792461076896124636935163284072466415339475869348991747659374068270652923128794611435079728489232122948179139197547105159952184231485291647613944223516450080883783540351500360106831879612194331391872641037161673244469591268235189667939691167302161427391206555938078520320564149433927306713056434689300750584217302607803804849162996945453960388589576433514450931587322042461589005902688639249894585367101942527518672906958428684989901046887818040748667377553642721872919254441104379963680746321602265998423512578545469859243244107381159471514440291591999221623568031461898015393860750228229154460555520746111342574014851882064314878187293289220899929807)  
ct = 556929789932718354289291849394616085746017472924699209648914037202503416575540852830970664161255326023268634267454107774965420213413821042576276508575455454361523573097884468178170003077347056594772266618658709362255877582064457508199710666562370947380840565162429512173936308204532454076794768514066924004746803038256412552237658292113081608006251236076708578344122432586668187584141207615427828061411854105828515375964545783967241743237338987432939077584028379144738368932124095367932978939269991855150473979077827471523074357255458371128658173282444008289098805775210188129191929555599684770996221844343085502091025637291770521228572273689936242153064802513056303923914150604670956717223303806593746367470261209586104020700589223881827015327135689001439309533530597224229719728250381029314935622264783085597813127891143325840103161823613658376562092838968353695725179031099723570207527561818677173920140026394852719332897635673091839874217580098458961022224756236920496049672662910077320373061540661712874310205443131382764229256203955927297599654747525835793142357208317882463486124468731953065393841513854916505999541748109264234674614040515601134746212095952825656454587128065358700074118271602538129048748869380854865933904021  
"""
```

```python
import owiener
from Crypto.Util.number import long_to_bytes

e = [...]
N = [...]
c = [....]

d = owiener.attack(e, N)

if d:
    m = pow(c, d, N)
    flag = long_to_bytes(m).decode()
    print(flag)
else:
    print("Wiener's Attack failed.")
```

Could also use RsaCtfTool.py from GitHub.
![](Pasted%20image%2020241111222754.png)

`4T${E_was_a_little_too_strong_this_time}`

# Docker

## A Simple Container

This is a challenge where you must do a simple api request.

In this particular challenge you had access to a server.

I first ran `docker ps` to list active docker containers
![](Pasted%20image%2020241111223331.png)

You can see open ports by running the command `ss -tuln`

![](Pasted%20image%2020241111223502.png)
not very helpful...

I accessed the container `admin-app-1` with the following command `docker exec -it admin-app-1 /bin/bash`

![](Pasted%20image%2020241111223736.png)

one can login as root using the command: `docker exec -u root -it admin-app-1 /bin/bash`

![](Pasted%20image%2020241111223853.png)

`4T${SIMPLE_is_VERy_$1mple_aM_i_r1ght}`

## A simple treasure

**Input**: [This](https://hub.docker.com/repository/docker/unshade/what/general) docker image

After explored the files inside the Docker container found the second part of the flag in app.py

for the first part, I used `grep -r` to search through the files. 

`4T${d0ck3r_1s_fun}`

## Insanity check 2

**Description**:
![](Pasted%20image%2020241111225236.png)

So easy, 71 page input PDF, with some python tweaking...

```python
import pdfplumber
def extract_text_from_pdf(file_path):
    # List to store text from each page
    pages_text = []
    # Open the PDF file using pdfplumber
    with pdfplumber.open(file_path) as pdf:
        # Iterate through all the pages
        for page in pdf.pages:
            # Extract text from each page
            page_text = page.extract_text()
            # Remove spaces and newline characters from the text
            page_text_no_spaces = page_text.replace(" ", "").replace("\n", "")
            # Append the text without spaces and newlines to the list
            pages_text.append(page_text_no_spaces)
    return pages_text

def get_nth_characters(pages_text):
    nth_characters = []
    for i, text in enumerate(pages_text):
        n = i + 1  # Page numbers are 1-based
        if len(text) >= n:
            # n-1 because Python uses 0-based indexing
            nth_characters.append(text[n - 1])
    return nth_characters

# Example usage
file_path = 'J:\\CTF\\4t\\owasp.pdf'  # Replace with your PDF file path
page_texts = extract_text_from_pdf(file_path)

# Get the nth characters from each page
nth_characters = get_nth_characters(page_texts)

# Form the flag
flag = "4T${" + "".join(nth_characters) + "}"
print(flag)
```

![](Pasted%20image%2020241111225612.png)

`4T${Aa.tCesiepVsiCrGe3AndolSSe2acseteono#oirne,euoesidsfopTaoltOooviqtplinc}`

